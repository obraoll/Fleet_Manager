<!-- Views/SettingsWindow.xaml -->
<Window x:Class="FleetManager.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        mc:Ignorable="d"
        Title="âš™ï¸ Configuration - Fleet Manager"
        Height="600" Width="800"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundBrush}">


    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="White" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="20">
            <StackPanel>
                <TextBlock Text="âš™ï¸ Configuration de l'Application" FontSize="20" FontWeight="Bold"/>
                <TextBlock Text="Personnalisez les paramÃ¨tres de Fleet Manager" FontSize="12" Foreground="#666666" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <!-- Contenu principal -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="20">
            <StackPanel>

                <!-- Section Base de donnÃ©es -->
                <Border Style="{StaticResource ModernCard}">
                    <StackPanel>
                        <TextBlock Style="{StaticResource H2}" Text="ðŸ—„ï¸ Base de DonnÃ©es"/>

                        <TextBlock Style="{StaticResource LabelStyle}" Text="Serveur:"/>
                        <TextBox Text="{Binding DatabaseServer, UpdateSourceTrigger=PropertyChanged}" 
                                 Padding="8" IsReadOnly="True" Background="{StaticResource BackgroundLightBrush}"/>

                        <TextBlock Style="{StaticResource LabelStyle}" Text="Base de donnÃ©es:"/>
                        <TextBox Text="{Binding DatabaseName, UpdateSourceTrigger=PropertyChanged}" 
                                 Padding="8" IsReadOnly="True" Background="{StaticResource BackgroundLightBrush}"/>

                        <TextBlock Style="{StaticResource LabelStyle}" Text="Statut de connexion:"/>
                        <Grid Margin="0,5,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Ellipse Width="12" Height="12" Fill="{Binding ConnectionStatusColor}" Grid.Column="0" Margin="0,0,10,0"/>
                            <TextBlock Text="{Binding ConnectionStatusText}" Grid.Column="1" VerticalAlignment="Center"/>
                            <Button Content="ðŸ”„ Tester" Command="{Binding TestConnectionCommand}" 
                                    Grid.Column="2" Padding="10,5" Background="#2196F3" Foreground="White" BorderThickness="0"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Section Alertes -->
                <Border Style="{StaticResource ModernCard}">
                    <StackPanel>
                        <TextBlock Style="{StaticResource H2}" Text="ðŸ”” Alertes et Notifications"/>

                        <CheckBox Content="Activer les alertes de maintenance" 
                                  IsChecked="{Binding EnableMaintenanceAlerts}" 
                                  Margin="0,5"/>
                        
                        <TextBlock Style="{StaticResource LabelStyle}" Text="DÃ©lai d'alerte maintenance (jours):"/>
                        <Slider Minimum="7" Maximum="90" Value="{Binding MaintenanceAlertDays}" 
                                TickFrequency="7" IsSnapToTickEnabled="True" Margin="0,5"/>
                        <TextBlock Text="{Binding MaintenanceAlertDays, StringFormat={}{0} jours avant Ã©chÃ©ance}" 
                                   FontSize="11" Foreground="#666" HorizontalAlignment="Center"/>

                        <CheckBox Content="Activer les alertes d'assurance" 
                                  IsChecked="{Binding EnableInsuranceAlerts}" 
                                  Margin="0,15,0,5"/>

                        <TextBlock Style="{StaticResource LabelStyle}" Text="DÃ©lai d'alerte assurance (jours):"/>
                        <Slider Minimum="7" Maximum="90" Value="{Binding InsuranceAlertDays}" 
                                TickFrequency="7" IsSnapToTickEnabled="True" Margin="0,5"/>
                        <TextBlock Text="{Binding InsuranceAlertDays, StringFormat={}{0} jours avant expiration}" 
                                   FontSize="11" Foreground="#666" HorizontalAlignment="Center"/>

                        <CheckBox Content="Activer les alertes de consommation Ã©levÃ©e" 
                                  IsChecked="{Binding EnableHighConsumptionAlerts}" 
                                  Margin="0,15,0,5"/>

                        <TextBlock Style="{StaticResource LabelStyle}" Text="Seuil de consommation Ã©levÃ©e (%):"/>
                        <Slider Minimum="10" Maximum="50" Value="{Binding HighConsumptionThreshold}" 
                                TickFrequency="5" IsSnapToTickEnabled="True" Margin="0,5"/>
                        <TextBlock Text="{Binding HighConsumptionThreshold, StringFormat=+{0}% au-dessus de la moyenne}" 
                                   FontSize="11" Foreground="#666" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- Section Rapports -->
                <Border Style="{StaticResource ModernCard}">
                    <StackPanel>
                        <TextBlock Style="{StaticResource H2}" Text="ðŸ“Š Rapports et Exports"/>

                        <TextBlock Style="{StaticResource LabelStyle}" Text="Format de date par dÃ©faut:"/>
                        <ComboBox SelectedItem="{Binding DefaultDateFormat}" Padding="8" Margin="0,5,0,10">
                            <ComboBoxItem Content="dd/MM/yyyy"/>
                            <ComboBoxItem Content="MM/dd/yyyy"/>
                            <ComboBoxItem Content="yyyy-MM-dd"/>
                        </ComboBox>

                        <TextBlock Style="{StaticResource LabelStyle}" Text="SÃ©parateur CSV:"/>
                        <ComboBox SelectedItem="{Binding CsvSeparator}" Padding="8" Margin="0,5,0,10">
                            <ComboBoxItem Content="Point-virgule (;)"/>
                            <ComboBoxItem Content="Virgule (,)"/>
                            <ComboBoxItem Content="Tabulation"/>
                        </ComboBox>

                        <TextBlock Style="{StaticResource LabelStyle}" Text="Dossier d'export par dÃ©faut:"/>
                        <Grid Margin="0,5,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Text="{Binding DefaultExportFolder, UpdateSourceTrigger=PropertyChanged}" 
                                     Padding="8" Grid.Column="0"/>
                            <Button Content="ðŸ“ Parcourir" Command="{Binding BrowseFolderCommand}" 
                                    Grid.Column="1" Padding="10,5" Margin="5,0,0,0" Background="#9E9E9E" Foreground="White" BorderThickness="0"/>
                        </Grid>

                        <CheckBox Content="Inclure les graphiques dans les exports PDF" 
                                  IsChecked="{Binding IncludeChartsInPdf}" 
                                  Margin="0,15,0,5"/>

                        <CheckBox Content="Ouvrir automatiquement les fichiers aprÃ¨s export" 
                                  IsChecked="{Binding AutoOpenExportedFiles}" 
                                  Margin="0,5"/>
                    </StackPanel>
                </Border>

                <!-- Section Affichage -->
                <Border Style="{StaticResource ModernCard}">
                    <StackPanel>
                        <TextBlock Style="{StaticResource H2}" Text="ðŸŽ¨ Affichage"/>

                        <TextBlock Style="{StaticResource LabelStyle}" Text="Nombre d'Ã©lÃ©ments par page:"/>
                        <ComboBox SelectedItem="{Binding ItemsPerPage}" Padding="8" Margin="0,5,0,10">
                            <ComboBoxItem Content="10"/>
                            <ComboBoxItem Content="25"/>
                            <ComboBoxItem Content="50"/>
                            <ComboBoxItem Content="100"/>
                        </ComboBox>

                        <CheckBox Content="Afficher les graphiques au dÃ©marrage" 
                                  IsChecked="{Binding ShowChartsOnStartup}" 
                                  Margin="0,5"/>

                        <CheckBox Content="Actualiser automatiquement le tableau de bord" 
                                  IsChecked="{Binding AutoRefreshDashboard}" 
                                  Margin="0,5"/>

                        <TextBlock Style="{StaticResource LabelStyle}" Text="Intervalle d'actualisation (minutes):"/>
                        <Slider Minimum="1" Maximum="60" Value="{Binding RefreshInterval}" 
                                TickFrequency="5" IsSnapToTickEnabled="True" Margin="0,5"
                                IsEnabled="{Binding AutoRefreshDashboard}"/>
                        <TextBlock Text="{Binding RefreshInterval, StringFormat=Toutes les {0} minutes}" 
                                   FontSize="11" Foreground="#666" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- Section Ã€ propos -->
                <Border Style="{StaticResource ModernCard}">
                    <StackPanel>
                        <TextBlock Style="{StaticResource H2}" Text="â„¹ï¸ Ã€ propos"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="Application:" Grid.Row="0" Grid.Column="0" Margin="0,5" FontWeight="SemiBold"/>
                            <TextBlock Text="Fleet Manager WPF" Grid.Row="0" Grid.Column="1" Margin="10,5"/>

                            <TextBlock Text="Version:" Grid.Row="1" Grid.Column="0" Margin="0,5" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding ApplicationVersion}" Grid.Row="1" Grid.Column="1" Margin="10,5"/>

                            <TextBlock Text="Framework:" Grid.Row="2" Grid.Column="0" Margin="0,5" FontWeight="SemiBold"/>
                            <TextBlock Text=".NET 8.0 / WPF" Grid.Row="2" Grid.Column="1" Margin="10,5"/>

                            <TextBlock Text="Base de donnÃ©es:" Grid.Row="3" Grid.Column="0" Margin="0,5" FontWeight="SemiBold"/>
                            <TextBlock Text="MySQL / Entity Framework Core" Grid.Row="3" Grid.Column="1" Margin="10,5"/>
                        </Grid>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>

        <!-- Footer avec actions -->
        <Border Grid.Row="2" Background="White" BorderBrush="#E0E0E0" BorderThickness="0,1,0,0" Padding="20">
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <Button Content="ðŸ”„ Valeurs par dÃ©faut" Command="{Binding ResetToDefaultCommand}"
                            Padding="15,8" Margin="0,0,10,0" Background="#FF9800" Foreground="White" BorderThickness="0"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="ðŸ’¾ Enregistrer" Command="{Binding SaveCommand}"
                            Padding="15,8" Margin="5" Background="#4CAF50" Foreground="White" BorderThickness="0"/>
                    <Button Content="âœ– Annuler" Command="{Binding CancelCommand}"
                            Padding="15,8" Margin="5" Background="#9E9E9E" Foreground="White" BorderThickness="0"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
