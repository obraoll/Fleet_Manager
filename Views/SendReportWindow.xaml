<Window x:Class="FleetManager.Views.SendReportWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Envoi de Rapport par Email" Height="500" Width="600"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">

    <Window.Resources>
        <Style TargetType="Border" x:Key="CardStyle">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.2"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="TextBlock" x:Key="LabelStyle">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,10,0,5"/>
            <Setter Property="Foreground" Value="#333"/>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Padding" Value="8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="BorderBrush" Value="#CCC"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Titre -->
        <TextBlock Grid.Row="0" Text="ðŸ“§ Envoi de Rapport par Email" 
                   FontSize="20" FontWeight="Bold" 
                   Foreground="#1976D2" Margin="0,0,0,20"/>

        <!-- Formulaire -->
        <Border Grid.Row="1" Style="{StaticResource CardStyle}">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <!-- Destinataire -->
                    <TextBlock Text="Destinataire *" Style="{StaticResource LabelStyle}"/>
                    <TextBox x:Name="RecipientTextBox" 
                             Text="{Binding RecipientEmail, UpdateSourceTrigger=PropertyChanged}"
                             ToolTip="Adresse email du destinataire"/>

                    <!-- Liste de destinataires suggÃ©rÃ©s -->
                    <TextBlock Text="Destinataires suggÃ©rÃ©s" Style="{StaticResource LabelStyle}"/>
                    <ListBox ItemsSource="{Binding SuggestedEmails}" 
                             SelectionMode="Single"
                             Height="100"
                             SelectionChanged="SuggestedEmail_SelectionChanged">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“§" Margin="0,0,5,0"/>
                                    <TextBlock Text="{Binding}"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>

                    <!-- Type de rapport -->
                    <TextBlock Text="Type de rapport *" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="ReportTypeComboBox" 
                              SelectedItem="{Binding SelectedReportType}"
                              Height="35">
                        <ComboBoxItem Content="ðŸ“Š Statistiques GÃ©nÃ©rales" IsSelected="True"/>
                        <ComboBoxItem Content="ðŸ“ˆ Rapport Mensuel"/>
                        <ComboBoxItem Content="ðŸ’° Rapport de CoÃ»ts"/>
                        <ComboBoxItem Content="â›½ Rapport de Consommation"/>
                        <ComboBoxItem Content="ðŸ”§ Rapport de Maintenance"/>
                    </ComboBox>

                    <!-- PÃ©riode -->
                    <TextBlock Text="PÃ©riode" Style="{StaticResource LabelStyle}"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <DatePicker Grid.Column="0" 
                                    SelectedDate="{Binding StartDate}"
                                    FirstDayOfWeek="Monday"
                                    Height="35"/>
                        <TextBlock Grid.Column="1" Text=" Ã  " 
                                   VerticalAlignment="Center" 
                                   Margin="10,0"/>
                        <DatePicker Grid.Column="2" 
                                    SelectedDate="{Binding EndDate}"
                                    FirstDayOfWeek="Monday"
                                    Height="35"/>
                    </Grid>

                    <!-- Message personnalisÃ© -->
                    <TextBlock Text="Message (optionnel)" Style="{StaticResource LabelStyle}"/>
                    <TextBox Text="{Binding CustomMessage, UpdateSourceTrigger=PropertyChanged}"
                             Height="80"
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             VerticalScrollBarVisibility="Auto"/>

                    <!-- Format -->
                    <TextBlock Text="Format du fichier" Style="{StaticResource LabelStyle}"/>
                    <StackPanel Orientation="Horizontal">
                        <RadioButton Content="ðŸ“„ PDF" 
                                     IsChecked="{Binding IsPdfFormat}" 
                                     Margin="0,0,20,0" 
                                     VerticalAlignment="Center"/>
                        <RadioButton Content="ðŸ“Š Excel" 
                                     IsChecked="{Binding IsExcelFormat}" 
                                     VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Options -->
                    <TextBlock Text="Options" Style="{StaticResource LabelStyle}"/>
                    <StackPanel>
                        <CheckBox Content="Inclure les graphiques" 
                                  IsChecked="{Binding IncludeCharts}" 
                                  Margin="0,5"/>
                        <CheckBox Content="Inclure les dÃ©tails par vÃ©hicule" 
                                  IsChecked="{Binding IncludeVehicleDetails}" 
                                  Margin="0,5"/>
                        <CheckBox Content="Inclure les recommandations" 
                                  IsChecked="{Binding IncludeRecommendations}" 
                                  Margin="0,5"/>
                    </StackPanel>

                    <!-- Ã‰tat d'envoi -->
                    <Border Background="#E3F2FD" 
                            CornerRadius="5" 
                            Padding="10" 
                            Margin="0,15,0,0"
                            Visibility="{Binding StatusMessageVisibility}">
                        <TextBlock Text="{Binding StatusMessage}" 
                                   TextWrapping="Wrap" 
                                   Foreground="#1565C0"/>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Boutons -->
        <Border Grid.Row="2" Background="White" Padding="15" Margin="-20,10,-20,-20">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="ðŸ“§ Envoyer" Width="150" Height="40"
                        Command="{Binding SendCommand}"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Margin="0,0,10,0"/>
                <Button Content="Annuler" Width="120" Height="40"
                        IsCancel="True"
                        Click="CancelButton_Click"
                        Style="{StaticResource SecondaryButtonStyle}"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
