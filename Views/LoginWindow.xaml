<Window x:Class="FleetManager.Views.LoginWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Fleet Manager - Connexion"
        Height="580" Width="420"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent">

    <Border CornerRadius="8" Background="White" BorderBrush="#E5E7EB" BorderThickness="1">
        <Border.Effect>
            <DropShadowEffect Color="#000000" Direction="0" ShadowDepth="0" Opacity="0.12" BlurRadius="8"/>
        </Border.Effect>
        
        <Grid>
            <!-- Bouton fermer -->
            <Button Content="âœ•"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Margin="0,12,12,0"
                    Width="28"
                    Height="28"
                    Background="Transparent"
                    BorderThickness="0"
                    Foreground="#9CA3AF"
                    FontSize="16"
                    Cursor="Hand"
                    Click="CloseButton_Click"
                    Style="{StaticResource IconButton}"/>

            <!-- Contenu principal -->
            <StackPanel VerticalAlignment="Center" Margin="32,50,32,32">
                <!-- En-tÃªte -->
                <StackPanel HorizontalAlignment="Center" Margin="0,0,0,32">
                    <Border Width="48" Height="48" Background="#6366F1" CornerRadius="8" Margin="0,0,0,16">
                        <TextBlock Text="ðŸš—" FontSize="24" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <TextBlock Text="Fleet Manager"
                               Style="{StaticResource H1}"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,6"/>
                    <TextBlock Text="Connectez-vous pour accÃ©der Ã  votre compte"
                               Style="{StaticResource SmallText}"
                               HorizontalAlignment="Center"/>
                </StackPanel>

                <!-- Formulaire -->
                <StackPanel>
                    <!-- Email -->
                    <TextBlock Text="Email"
                               Style="{StaticResource FormLabel}"/>
                    
                    <Border x:Name="EmailBorder"
                            BorderBrush="#E5E7EB" 
                            BorderThickness="1" 
                            CornerRadius="6"
                            Background="White"
                            Margin="0,0,0,16">
                        <TextBox x:Name="UsernameTextBox"
                                 Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}"
                                 Style="{x:Null}"
                                 Foreground="#111827"
                                 CaretBrush="#111827"
                                 SelectionBrush="#6366F1"
                                 SelectionOpacity="0.3"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 FontFamily="Segoe UI"
                                 FontSize="13"
                                 Height="44"
                                 Padding="12,10"
                                 VerticalContentAlignment="Center"
                                 GotFocus="UsernameTextBox_GotFocus"
                                 LostFocus="UsernameTextBox_LostFocus"/>
                    </Border>

                    <!-- Mot de passe -->
                    <TextBlock Text="Mot de passe"
                               Style="{StaticResource FormLabel}"/>
                    
                    <Border x:Name="PasswordBorder"
                            BorderBrush="#E5E7EB" 
                            BorderThickness="1" 
                            CornerRadius="6"
                            Background="White"
                            Margin="0,0,0,12">
                        <PasswordBox x:Name="PasswordBox"
                                    PasswordChanged="PasswordBox_PasswordChanged"
                                    Style="{x:Null}"
                                    Foreground="#111827"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    FontFamily="Segoe UI"
                                    FontSize="13"
                                    Height="44"
                                    Padding="12,10"
                                    VerticalContentAlignment="Center"
                                    GotFocus="PasswordBox_GotFocus"
                                    LostFocus="PasswordBox_LostFocus"/>
                    </Border>


                    <!-- Message d'erreur -->
                    <Border Background="#FEE2E2"
                            BorderBrush="#FCA5A5"
                            BorderThickness="1"
                            CornerRadius="6"
                            Padding="10,8"
                            Margin="0,0,0,16"
                            Visibility="{Binding ErrorMessage, Converter={StaticResource BoolToVisibility}}">
                        <TextBlock Text="{Binding ErrorMessage}"
                                   Foreground="#DC2626"
                                   FontSize="12"
                                   TextWrapping="Wrap"/>
                    </Border>

                    <!-- Bouton de connexion -->
                    <Button Content="Se connecter"
                            Style="{StaticResource ModernButton}"
                            Command="{Binding LoginCommand}"
                            CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                            IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}"
                            Margin="0,0,0,12"/>

                    <!-- Indicateur de chargement -->
                    <StackPanel Orientation="Horizontal" 
                                HorizontalAlignment="Center" 
                                Margin="0,0,0,12"
                                Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibility}}">
                        <TextBlock Text="â³" FontSize="14" Margin="0,0,6,0"/>
                        <TextBlock Text="Connexion en cours..." 
                                   FontSize="12" 
                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                    </StackPanel>

                    <!-- Diagnostic -->
                    <Button Content="ðŸ”§ Tester la connexion"
                            Style="{StaticResource SecondaryButton}"
                            Command="{Binding DiagnosticCommand}"
                            IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}"
                            FontSize="12"
                            Height="32"/>
                </StackPanel>
            </StackPanel>
        </Grid>
    </Border>
</Window>
